{% extends 'datacatalog/base-catalog.html' %}

{# Load the tag library #}
{% load bootstrap4 %}
{% load project_tags %}

{# Load CSS and JavaScript #}
{% bootstrap_css %}
{% bootstrap_javascript %}

{# Display django.contrib.messages as Bootstrap alerts #}
{% bootstrap_messages %}

{% block content %}

<style>
/* styling of the tabs*/
#exTab1 .tab-content {
  color : black;
  padding : 5px 15px;
}

#exTab1 .nav-tabs > li > a {
  border-radius: 4px 4px 0 0;
}
</style>



<h1>
    {{ dataset.title }} 
</h1>
{% if dataset.publisher %}
<h2>
    <small class="text-muted"><a href="{% url 'datacatalog:provider-view' dataset.publisher.pk %}">{{ dataset.publisher }}</a></small>
</h2>
{% endif %}


<p> {{ dataset.description|linebreaks }}</p>

{% if dataset.data_fields.count %}
</br>

{% with dataset.data_fields.all as datafield_list %}
    {% include 'datacatalog/table_datafield.html' %}
{% endwith %}
{% endif %}

</br>
<h4>Details</h4>
<table class="table table-striped table-hover">
    {% if dataset.ds_id %}
    <tr>
        <td>Dataset ID</td>
        <td>{{ dataset.ds_id }}</td>
    </tr>
    {% endif %}
    {% if dataset.expert %}
    <tr>
        <td>Dataset local expert</td>
        <td>{{ dataset.expert }}</td>
    </tr>
    {% endif %}
    <tr>
        <td>Record Period Start</td>
        <td>{{ dataset.period_start }}</td>
    </tr>
    <tr>
        <td>Record Period End</td>
        <td>{{ dataset.period_end }}</td>
    </tr>
    {% if dataset.landing_url %}
    <tr>
        <td>Landing URL</td>
        <td><a href="{{ dataset.landing_url }}">{{ dataset.landing_url }}</a></td>
    </tr>
    {% endif %}
    <tr>
        <td>Local contact</td>
        <td>{% if dataset.expert %}
                {{ dataset.expert }}
            {% else %}
                None provided
            {% endif %}
        </td>
    </tr>
    
    
    <tr>
        <td>Keywords</td>
        <td>{% for kw in dataset.keywords.all %}
                <span class="badge progress-bar-info">
                <a  href="{% url 'datacatalog:keyword-view' kw.pk %}"
                    style="color:white;">
                    {{ kw.keyword }}
                </a></span>
            {% endfor %}
        </td>
    </tr>

</table>


{% if dataset.comments %}
</br>
</br>
<div class="alert alert-warning" role="alert">{{ dataset.comments }}</div>
{% endif %}

</br>

<div class="container col-xl-12">
{% for dua in published_duas %}
    {% if dua.reuse_scope %}
        <div class="container col-md-6">
         <div class="panel panel-primary">
          <div class="panel-heading">
            <h4>Data Reuse Scope: {{ dua.duaid }}</h4>
          </div>
          <div class="panel-body">

                <p> {{ dua.reuse_scope|linebreaks }}</p>
       
          </div>
         </div>
        </div>
    {% endif %}
{% endfor %}
{% for dua in published_duas %}
    {% if dua.storage_requirements %}
        <div class="container col-md-6">
         <div class="panel panel-warning">
          <div class="panel-heading">
            <h4>Data Storage Requirements: {{ dua.duaid }}</h4>
          </div>
          <div class="panel-body">

                <p> {{ dua.storage_requirements|linebreaks }}</p>
       
          </div>
         </div>
        </div>
    {% endif %}
{% endfor %}
{% for dua in published_duas %}
    {% if dua.access_conditions %}
        <div class="container col-md-6">
         <div class="panel panel-danger">
          <div class="panel-heading">
            <h4>Data Access Conditions: {{ dua.duaid }}</h4>
          </div>
          <div class="panel-body">

                <p> {{ dua.access_conditions|linebreaks }}</p>
       
          </div>
         </div>
        </div>
    {% endif %}
{% endfor %}
</div>

</br>

{% if request.user|has_group:"datacatalog_editor" %}
<a type="button" class="btn btn-primary" href="{% url 'datacatalog:dataset-update' dataset.pk %}">Update dataset details</a>
{% endif %}

</br></br>

{% if request.user|has_group:"dua_viewing_privileges" %}
{% if published_duas.count > 0 %}
<h2>DUAs for {{ dataset }}</h2>

    {% with published_duas as dua_list %}
        {% include 'datacatalog/table_duas.html' %}
    {% endwith %}
{% else%}
<h2>No DUAs for {{ dataset }}</h2>
{% endif %}
{% endif %}
{% endblock %}

